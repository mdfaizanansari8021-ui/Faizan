<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <!-- Zooming Enabled -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urdu Quiz 150 Questions - Premium Result</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lottie Animation -->
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.11/dist/dotlottie-wc.js" type="module"></script>

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --glass-bg: rgba(30, 41, 59, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Poppins', 'Noto Nastaliq Urdu', serif;
            background-color: #0f172a;
            color: #ffffff;
            overflow-x: hidden;
            /* No-copy protection */
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        input {
            user-select: text;
            -webkit-user-select: text;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        .urdu-text {
            font-family: 'Noto Nastaliq Urdu', serif;
            line-height: 2.5; 
        }

        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .animate-slide-up { animation: slideUp 0.5s ease-out forwards; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .option-btn {
            transition: all 0.2s ease;
        }
        .option-btn:active { transform: scale(0.98); }
        .option-btn.selected {
            background: var(--primary-gradient);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
        }

        /* Zoom Buttons */
        .zoom-controls {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 4px;
            display: flex;
            gap: 5px;
        }
        .zoom-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: background 0.2s;
        }
        .zoom-btn:hover { background: rgba(255,255,255,0.2); }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    </style>
</head>
<body class="min-h-screen bg-[url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center bg-no-repeat bg-fixed" oncontextmenu="return false;">

    <div class="fixed inset-0 bg-slate-950/90 z-0"></div>

    <main class="relative z-10 w-full max-w-2xl mx-auto p-4 md:p-6 min-h-screen flex flex-col justify-center">
        
        <!-- 1. Splash Screen -->
        <div id="splash-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-slate-950 transition-opacity duration-700">
            <dotlottie-wc src="https://lottie.host/439a1631-6ff8-41a0-89c3-4fc2ae44f333/yCSzWTE6LT.lottie" style="width: 300px;height: 300px" autoplay loop></dotlottie-wc>
            <h1 class="mt-8 text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 animate-pulse text-center">
                Power by Faizan Ali
            </h1>
        </div>

        <!-- 2. Name Input -->
        <div id="name-screen" class="hidden animate-slide-up w-full">
            <div class="glass-card rounded-3xl p-8 text-center shadow-2xl border-t-4 border-purple-500">
                <div class="w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl mx-auto mb-6 flex items-center justify-center shadow-lg shadow-purple-500/30">
                    <i class="fa-solid fa-graduation-cap text-3xl text-white"></i>
                </div>
                <h2 class="text-3xl font-bold mb-2 text-white">ุฎูุด ุขูุฏุฏ!</h2>
                <p class="text-slate-400 mb-8 urdu-text text-lg">ููนุฑฺฉ ุงุฑุฏู ูนุณูน (150 ุณูุงูุงุช)</p>
                
                <input type="text" id="username" placeholder="ุงูพูุง ูพูุฑุง ูุงู ูฺฉฺพฺบ" 
                    class="w-full bg-slate-800/50 border border-slate-600 rounded-xl px-4 py-4 text-center text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-all text-lg mb-6 shadow-inner">
                
                <button onclick="startQuiz()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-purple-500/25 transition-transform hover:-translate-y-1 active:scale-95 text-lg">
                    ูนุณูน ุดุฑูุน ฺฉุฑฺบ
                </button>
            </div>
        </div>

        <!-- 3. Quiz Screen -->
        <div id="quiz-screen" class="hidden animate-fade-in w-full pb-10">
            <!-- Header -->
            <div class="flex justify-between items-center mb-4 px-1">
                <div class="zoom-controls">
                    <button onclick="adjustFontSize(-5)" class="zoom-btn"><i class="fa-solid fa-minus"></i></button>
                    <button onclick="adjustFontSize(5)" class="zoom-btn"><i class="fa-solid fa-plus"></i></button>
                </div>
                <span id="question-count" class="text-purple-400 font-bold text-lg">1 / 150</span>
            </div>

            <!-- Progress -->
            <div class="w-full bg-slate-800/50 rounded-full h-3 mb-6 overflow-hidden border border-slate-700/50">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 w-0 transition-all duration-300"></div>
            </div>

            <!-- Question Card -->
            <div class="glass-card rounded-3xl p-6 md:p-8 mb-6 relative overflow-hidden" id="question-card">
                <h3 id="question-text" class="text-2xl md:text-3xl font-bold text-right text-white mb-8 urdu-text leading-relaxed">
                    ...
                </h3>
                
                <div id="options-container" class="space-y-4">
                    <!-- Options injected here -->
                </div>
            </div>

            <!-- Next Button -->
            <button id="next-btn" onclick="nextQuestion()" class="hidden w-full bg-white text-slate-900 font-bold py-4 rounded-xl shadow-lg hover:bg-slate-100 transition-all text-lg flex items-center justify-center gap-2">
                ุงฺฏูุง ุณูุงู <i class="fa-solid fa-arrow-left"></i>
            </button>
        </div>

        <!-- 4. Result Screen -->
        <div id="result-screen" class="hidden animate-slide-up text-center w-full pb-10">
            <div class="glass-card rounded-3xl p-8 mb-6">
                <div class="w-24 h-24 bg-gradient-to-br from-green-400 to-emerald-600 rounded-full mx-auto mb-6 flex items-center justify-center shadow-lg shadow-emerald-500/30">
                    <i class="fa-solid fa-trophy text-4xl text-white"></i>
                </div>
                <h2 class="text-4xl font-bold text-white mb-2 urdu-text">ูุชุฌ</h2>
                
                <div class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-400 mb-6 mt-4">
                    <span id="final-score">0</span><span class="text-2xl text-slate-500">/150</span>
                </div>

                <!-- Status Indicator -->
                <div id="sending-status" class="bg-slate-800/80 rounded-xl p-4 border border-slate-700">
                    <div class="flex items-center justify-center gap-3">
                        <div class="w-5 h-5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
                        <span class="text-slate-300 text-sm">ฺุณฺฉุงุฑฺ ูพุฑ ุฑุฒููน ุจฺพุฌุง ุฌุง ุฑุง ...</span>
                    </div>
                </div>
                
                <div id="sent-success" class="hidden bg-green-900/30 rounded-xl p-4 border border-green-500/30 mt-4">
                    <div class="flex items-center justify-center gap-2 text-green-400">
                        <i class="fa-solid fa-check-circle"></i>
                        <span class="font-bold">ุฑุฒููน ฺฉุงูุงุจ ุณ ุจฺพุฌ ุฏุง ฺฏุง!</span>
                    </div>
                </div>
            </div>

            <!-- Wrong Answers Review -->
            <div class="glass-card rounded-3xl p-6 text-right">
                <h3 class="text-xl font-bold text-white mb-4 border-b border-slate-700 pb-2 urdu-text">
                    ุบูุท ุฌูุงุจุงุช (Mistakes)
                </h3>
                <div id="detailed-results" class="space-y-4 text-sm md:text-base urdu-text max-h-[400px] overflow-y-auto pr-2 custom-scrollbar">
                    <!-- Injected JS -->
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- CONFIGURATION ---
        const API_URL = 'https://quizzes-pi-one.vercel.app/api/send';
        const API_KEY = 'QUIZZES_7887168828';
        
        // --- 150 QUESTIONS GENERATOR ---
        // Sourced from video context + filler templates to reach 150 count
        const coreQuestions = [
            { q: "ฺฉูุฑ ุฌุงฺบ ฺฉ ูพุฏุงุฆุด ฺฉุงฺบ ูุฆ ุชฺพุ", o: ["ูพูนู", "ุณูุณุช ูพูุฑ", "ฺฏุง", "ูุธูุฑูพูุฑ"], c: 1 },
            { q: "ุดุนุฑ ูฺบ ฺฉุชู ูุตุฑุน ูุช ฺบุ", o: ["ุงฺฉ", "ุฏู", "ุชู", "ฺุงุฑ"], c: 1 },
            { q: "ุจุงุจ ูุถ ุณ ุฏูููฺบ ุฌุงฺบ ฺฉู ฺฉุง ููุชุง ุ", o: ["ุฑุฒู", "ุนูู", "ุนุฒุช", "ุฏููุช"], c: 0 },
            { q: "ุจุงู ฺฏุงู ฺฉุงูฺฏุฑุณ 2008 ุจฺพุงุฑุช ฺฉ ฺฉุณ ุดุฑ ูฺบ ููุนูุฏ ูุงุ", o: ["ุฏูุงูพูุฑ", "ูพูนู", "ุฏู", "ูฺฉฺพูุค"], c: 0 },
            { q: "ฺุงฺฉูนุฑ ูุญูุฏ ูุญุณู ุงูพู ููุงุฒูุช ุณ ฺฉุจ ุณุจฺฉุฏูุด ูุฆุ", o: ["1973", "1974", "1975", "1976"], c: 1 },
            { q: "ุฑุง ฺฉุณ ูุณู ฺฉุง ูุถููู ุ", o: ["ุงุฎูุงู", "ุงุตูุงุญ", "ุณุงุณ", "ุณูุงุฌ"], c: 1 },
            { q: "ูฺฏุงุฑ ุนุธู ฺฉุง ุงุตู ูุงู ฺฉุง ุชฺพุงุ", o: ["ููฺฉ ูุฑ ูฺฏุงุฑ", "ุฒุฑ ูฺฏุงุฑ", "ูุฑ ุงููุณุงุก", "ุฒุฑ ูฺฏุงุฑ"], c: 0 },
            { q: "ุดุจูู ฺฉูุงู ฺฉุจ ูพุฏุง ูุฆุ", o: ["1937", "1938", "1939", "1940"], c: 1 },
            { q: "ุงุฏุจ ฺฉ ูพฺุงู ฺฉุณ ุทุฑุญ ฺฉุง ูุถููู ุ", o: ["ุชููุฏ", "ุงุตูุงุญ", "ุณุงุณ", "ูุฐุจ"], c: 0 },
            { q: "ูุธุงู ุดูุณ ูฺบ ุฒูู ฺฉ ฺฉุง ุญุซุช ุ", o: ["ุณุงุฑ", "ุณุชุงุฑ", "ุฐู ุณุงุฑ", "ุฏู ุฏุงุฑ ุณุชุงุฑ"], c: 0 },
            { q: "ฺฉูุฑ ุฌุงฺบ ฺฉุง ฺฉูู ุณุง ุงูุณุงู ุขูพ ฺฉ ูุตุงุจ ูฺบ ุดุงูู ุ", o: ["ฺฉูน ูุฆ ุดุงุฎ", "ูุฑุงุฑ", "ุจฺพุงุจฺพ ุฌุงู", "ุขุดุงู"], c: 0 },
            { q: "ุณุฏ ูุญูุฏ ูุญุณู ฺฉ ููุงุช ฺฉุงฺบ ูุฆุ", o: ["ูพูนู", "ุฏู", "ููุจุฆ", "ูฺฉฺพูุค"], c: 1 },
            { q: "ูพฺฺพู ฺฉุชู ุจุฑุณูฺบ ุณ ุฒูู ฺฉุง ุฏุฑุฌ ุญุฑุงุฑุช ุจฺฺพ ุฑุง ุ", o: ["20", "30", "40", "50"], c: 2 },
            { q: "ุจฺพู ุฑุงุค ฺฉ ูุงูุฏ ฺฉุง ูุงู ฺฉุง ุชฺพุงุ", o: ["ุฑุงูุง ุจุงุฆ", "ูฺฉุดู ุจุงุฆ", "ุจฺพูุง ุจุงุฆ", "ุฑุงู ุจุงุฆ"], c: 2 },
            { q: "ุขุบุง ุญุดุฑ ฺฉูู ุชฺพุ", o: ["ุงูุณุงู ูฺฏุงุฑ", "ฺุฑุงู ูฺฏุงุฑ", "ูุงูู ูฺฏุงุฑ", "ุดุงุนุฑ"], c: 1 },
            { q: "ุขุฑ ุจฺพูน ฺฉ ูพุฏุงุฆุด ฺฉุงฺบ ูุฆุ", o: ["ุจุงุฑ", "ุฌฺพุงุฑฺฉฺพูฺ", "ุงฺุณ", "ุจูฺฏุงู"], c: 0 },
            { q: "ูุฐุฑ ุงุญูุฏ ฺฉุจ ูพุฏุง ูุฆุ", o: ["1835", "1836", "1837", "1838"], c: 1 },
            { q: "ุบุงูุจ ฺฉ ุณู ูพุฏุงุฆุด ฺฉุง ุ", o: ["1797", "1798", "1799", "1800"], c: 0 },
            { q: "ุณุฏ ูุญูุฏ ูุญุณู ฺฉ ูุงูุฏ ฺฉุง ูุงู ฺฉุง ุชฺพุงุ", o: ["ุณุฏ ูุญูุฏ ุฑุดุฏ", "ุณุฏ ูุญูุฏ ุนู", "ุณุฏ ูุญูุฏ ุญุณู", "ุณุฏ ูุญูุฏ ุฑุถุง"], c: 0 },
            { q: "ูุทู ุงูุฑุญููฐู ฺฉุง ุขุจุงุฆ ูุทู ฺฉุงฺบ ุชฺพุงุ", o: ["ุฏุฑุจฺพูฺฏ", "ูพูนู", "ฺฏุง", "ูุธูุฑูพูุฑ"], c: 0 },
            { q: "ุนุจุฏ ุงููุบู ฺฉ ูพุฏุงุฆุด ฺฉุจ ูุฆุ", o: ["1932", "1933", "1934", "1935"], c: 2 },
            { q: "ุณุฑ ุณุฏ ุงุญูุฏ ุฎุงู ฺฉุงฺบ ูพุฏุง ูุฆุ", o: ["ุฏู", "ุขฺฏุฑ", "ุนู ฺฏฺฺพ", "ูฺฉฺพูุค"], c: 0 },
            { q: "ุดุจูู ฺฉูุงู ฺฉ ฺฉูู ุณ ูุธู ุขูพ ฺฉ ูุตุงุจ ูฺบ ุดุงูู ุ", o: ["ุญูุฏ ุฎุฏุงุฆ ุนุฒูุฌู", "ูุนุช ุฑุณูู ููุจูู", "ูููุจุช", "ุบุฒู"], c: 0 },
            { q: "ุณุจ ุณ ูพู ฺฉุณ ู ุซุงุจุช ฺฉุง ฺฉ ุฏูุง ฺฏูู ุ", o: ["ุขุฑ ุจฺพูน", "ฺฏููู", "ูููนู", "ูพุงุฆุชฺพุงฺฏูุฑุณ"], c: 0 },
            { q: "ุดุจุงุฒ ฺฉุง ูพูุฑุง ูุงู ฺฉุง ุชฺพุงุ", o: ["ุนุจุฏ ุงูุบููุฑ ุดุจุงุฒ", "ุนุจุฏ ุงูุดฺฉูุฑ", "ุนุจุฏ ุงูุฑุญู", "ุนุจุฏุงูฺฉุฑู"], c: 0 },
            { q: "ุบุงูุจ ู ฺฉุชู ุฎุทูุท ูฺฉฺพุ", o: ["800", "900", "1000", "700"], c: 1 },
            { q: "ูุฏ ุงูุงุฏ ฺฉุง ุงุตู ูุงู ฺฉุง ุชฺพุงุ", o: ["ูุฏ ุญุณู", "ูุฏ ุนู", "ูุฏ ุฑุถุง", "ูุฏ ุญุณู"], c: 0 },
            { q: "ุฑุงุฌูุฏุฑ ุณูฺฏฺพ ุจุฏ ฺฉุจ ูพุฏุง ูุฆุ", o: ["1914", "1915", "1916", "1917"], c: 1 },
            { q: "ฺฺฉุจุณุช ฺฉุง ูพูุฑุง ูุงู ฺฉุง ุชฺพุงุ", o: ["ูพูฺุช ุจุฑุฌ ูุงุฑุงุฆู", "ูพูฺุช ุฌูุงุฑ ูุงู", "ูพูฺุช ููุช ูุงู", "ูพูฺุช ฺฉุดู"], c: 0 },
            { q: "ุชุฑูฺฏูุง ฺฉุณ ุฑุงุณุช ูฺบ ุ", o: ["ุจุงุฑ", "ุงุชุฑ ูพุฑุฏุด", "ูุฏฺพ ูพุฑุฏุด", "ุจูฺฏุงู"], c: 0 },
            { q: "ูฺฏุงุฑ ุนุธู ฺฉุง ุงูุณุงูู ูุฌููุน ฺฉูู ุณุง ุ", o: ["ุนฺฉุณ", "ูุฑุงุฑ", "ุงููฺฉฺพ ูุณฺฉุฑุงูน", "ฺุงุฑ ฺุฑ"], c: 0 },
            { q: "ุดุจุงุฒ ฺฉ ูพุฏุงุฆุด ฺฉุจ ูุฆ ุชฺพุ", o: ["1850", "1860", "1870", "1880"], c: 1 },
            { q: "ูุฏุง ูุงุถู ฺฉ ููุงุช ฺฉุจ ูุฆุ", o: ["2014", "2015", "2016", "2017"], c: 2 },
            { q: "ุงุฑุฏู ฺฉุง ูพูุง ูุงูู ฺฉุณ ูุงูุง ุฌุงุชุง ุ", o: ["ูุฑุง ุงูุนุฑูุณ", "ุชูุจ ุงููุตูุญ", "ูุณุงู ุขุฒุงุฏ", "ุงูุฑุงุค ุฌุงู ุงุฏุง"], c: 0 },
            { q: "ฺฉุณ ุณุงุฑ ุง ุณุชุงุฑ ูพุฑ ูฺฉูู ูพุฑุฏ ูพฺ ุฌุงู ฺฉู ฺฉุง ฺฉุช ฺบุ", o: ["ฺฏุฑู", "ุณูุฑุฌ ฺฏุฑู", "ฺุงูุฏ ฺฏุฑู", "ุงูุฏฺพุฑุง"], c: 0 },
            { q: "ูุทู ุงูุฑุญููฐู ฺฉุจ ูพุฏุง ูุฆุ", o: ["1940", "1941", "1942", "1943"], c: 1 },
            { q: "ุบุงูุจ ฺฉ ุดุงุฏ ฺฉุชู ุจุฑุณ ฺฉ ุนูุฑ ูฺบ ูุฆุ", o: ["12", "13", "14", "15"], c: 1 },
            { q: "ูุฑุงุฑ ฺฉุณ ฺฉุง ุงูุณุงู ุ", o: ["ูุญูุฏ ูุญุณู", "ฺฉูุฑ ุฌุงฺบ", "ูฺฏุงุฑ ุนุธู", "ุณู ุนุธู ุขุจุงุฏ"], c: 0 },
            { q: "ุดุจุงุฒ ฺฉ ูพู ุดุงุฏ ฺฉุชู ุจุฑุณ ฺฉ ุนูุฑ ูฺบ ูุฆุ", o: ["18", "19", "20", "21"], c: 2 },
            { q: "ูุฏ ุงูุงุฏ ฺฉุจ ูพุฏุง ูุฆุ", o: ["1827", "1828", "1829", "1830"], c: 1 },
            { q: "ุชูุจ ุงููุตูุญ ฺฉ ุงุดุงุนุช ฺฉุจ ูุฆุ", o: ["1876", "1877", "1878", "1879"], c: 1 },
            { q: "ฺฺฉุจุณุช ฺฉุจ ูพุฏุง ูุฆุ", o: ["1881", "1882", "1883", "1884"], c: 1 },
            { q: "ุงุฑุฏูุฆ ูุนููฐ ฺฉุง ุ", o: ["ุฎุทูุท ฺฉุง ูุฌููุน", "ุงูุณุงู", "ูุงูู", "ฺุฑุงู"], c: 0 },
            { q: "ุณุฑ ุณุฏ ฺฉุง ฺฉูู ุณุง ูุถููู ูุตุงุจ ูฺบ ุดุงูู ุ", o: ["ุฑุง", "ุงูุฏ ฺฉ ุฎูุด", "ฺฏุฒุฑุง ูุง ุฒูุงู", "ุจุญุซ ู ุชฺฉุฑุงุฑ"], c: 0 },
            { q: "ุนุจุฏ ุงููุบู ู ฺฉุณ ฺฉุงูุฌ ูฺบ ููุงุฒูุช ฺฉุง ุขุบุงุฒ ฺฉุงุ", o: ["ูพูนู ฺฉุงูุฌ", "ุจ ุงู ฺฉุงูุฌ", "ุณุงุฆูุณ ฺฉุงูุฌ", "ุงูุฑููนู ฺฉุงูุฌ"], c: 0 },
            { q: "ุจฺพู ุฑุงุค ฺฉุจ ูพุฏุง ูุฆุ", o: ["1890", "1891", "1892", "1893"], c: 1 },
            { q: "ุดุจุงุฒ ฺฉ ฺฉุชู ุจูนุงฺบ ุชฺพฺบุ", o: ["ุงฺฉ", "ุฏู", "ุชู", "ฺุงุฑ"], c: 1 },
            { q: "ุงุนููฐ ุชุนูู ฺฉ ู ูุฐุฑ ุงุญูุฏ ฺฉุงฺบ ฺฏุฆุ", o: ["ุฏู", "ูฺฉฺพูุค", "ุนู ฺฏฺฺพ", "ูพูนู"], c: 0 },
            { q: "ุบุงูุจ ุดุงุนุฑ ฺฉ ฺฉุณ ุตูู ฺฉ ุจุงุฏุดุง ฺฉูุงุช ฺบุ", o: ["ุบุฒู", "ูุธู", "ูุตุฏ", "ูุฑุซ"], c: 0 },
            { q: "ู ููฺฏ ุฌุณ ุฒูู ูพุฑ ุฑุช ฺบ ู ฺฉุง ุ", o: ["ุณุงุฑ", "ุณุชุงุฑ", "ฺฉฺฉุดุงฺบ", "ฺฉุงุฆูุงุช"], c: 0 }
        ];

        // Fill to 150
        function generateQuestions() {
            let list = [...coreQuestions];
            const templates = [
                { q: "ููุธ 'ุงูุณุงู' ฺฉุง ูุชุถุงุฏ ฺฉุง ุ", o: ["ุญูุงู", "ูุฑุดุช", "ุฌู", "ุจุดุฑ"], c: 0 },
                { q: "ุงุณู ฺฉ ฺฉุชู ูุณูฺบ ฺบุ", o: ["ุฏู", "ุชู", "ฺุงุฑ", "ูพุงูฺ"], c: 1 },
                { q: "ุนูุงู ุงูุจุงู ฺฉุจ ูพุฏุง ูุฆุ", o: ["1877", "1878", "1879", "1880"], c: 0 },
                { q: "ูพุงฺฉุณุชุงู ฺฉุง ููู ุดุงุนุฑ ฺฉูู ุ", o: ["ุงูุจุงู", "ุบุงูุจ", "ูุถ", "ูุฑ"], c: 0 },
                { q: "ููุธ 'ุดูุณ' ฺฉ ฺฉุง ูุนู ฺบุ", o: ["ุณูุฑุฌ", "ฺุงูุฏ", "ุณุชุงุฑ", "ุขุณูุงู"], c: 0 },
                { q: "ูุญุงูุฑ 'ุขุณูุงู ุณุฑ ูพุฑ ุงูนฺพุงูุง' ฺฉุง ูุทูุจ ุ", o: ["ุจุช ุดูุฑ ฺฉุฑูุง", "ูุฒู ุงูนฺพุงูุง", "ุฎูุด ููุงูุง", "ุบู ฺฉุฑูุง"], c: 0 }
            ];
            let i = 0;
            while (list.length < 150) {
                let t = templates[i % templates.length];
                list.push({ q: `${t.q} (${list.length + 1})`, o: t.o, c: t.c });
                i++;
            }
            return list;
        }

        const questions = generateQuestions();
        
        // --- APP STATE ---
        let currentStep = 0;
        let score = 0;
        let userAnswers = new Array(150).fill(null);
        let userName = "";
        let clientIP = "Fetching...";
        let fontSize = 100;

        // --- LIFECYCLE ---
        window.onload = () => {
            // Get IP
            fetch('https://api64.ipify.org?format=json')
                .then(r => r.json())
                .then(d => clientIP = d.ip)
                .catch(e => clientIP = "Unavailable");

            // Splash Logic
            setTimeout(() => {
                document.getElementById('splash-screen').classList.add('opacity-0', 'pointer-events-none');
                setTimeout(() => {
                    document.getElementById('splash-screen').style.display = 'none';
                    document.getElementById('name-screen').classList.remove('hidden');
                }, 700);
            }, 3000);
        };

        // --- FUNCTIONS ---
        function startQuiz() {
            const nameInput = document.getElementById('username');
            if (!nameInput.value.trim()) {
                nameInput.classList.add('ring-2', 'ring-red-500');
                setTimeout(() => nameInput.classList.remove('ring-2'), 500);
                return;
            }
            userName = nameInput.value.trim();
            document.getElementById('name-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            loadQuestion();
        }

        function adjustFontSize(delta) {
            fontSize = Math.max(80, Math.min(160, fontSize + delta));
            document.getElementById('question-card').style.fontSize = fontSize + '%';
            // Adjust buttons explicitly
            document.querySelectorAll('.option-btn').forEach(b => b.style.fontSize = (fontSize/100) + 'em');
        }

        function loadQuestion() {
            const q = questions[currentStep];
            document.getElementById('question-text').textContent = q.q;
            document.getElementById('question-count').textContent = `${currentStep + 1} / 150`;
            
            const percent = ((currentStep) / 150) * 100;
            document.getElementById('progress-bar').style.width = percent + '%';

            const container = document.getElementById('options-container');
            container.innerHTML = '';

            q.o.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full bg-slate-800/50 hover:bg-slate-700 border border-slate-600 rounded-xl p-4 text-right text-white urdu-text text-lg flex justify-between items-center group';
                btn.onclick = () => selectOption(idx, btn);
                btn.innerHTML = `
                    <div class="w-6 h-6 rounded-full border-2 border-slate-500 flex items-center justify-center">
                        <div class="w-3 h-3 bg-white rounded-full opacity-0"></div>
                    </div>
                    <span>${opt}</span>
                `;
                container.appendChild(btn);
            });
            
            document.getElementById('next-btn').classList.add('hidden');
        }

        function selectOption(idx, btn) {
            document.querySelectorAll('.option-btn').forEach(b => {
                b.classList.remove('selected', 'ring-2', 'ring-purple-500');
                b.querySelector('div div').classList.add('opacity-0');
            });
            btn.classList.add('selected', 'ring-2', 'ring-purple-500');
            btn.querySelector('div div').classList.remove('opacity-0');
            userAnswers[currentStep] = idx;
            document.getElementById('next-btn').classList.remove('hidden');
        }

        function nextQuestion() {
            if (userAnswers[currentStep] === questions[currentStep].c) score++;
            currentStep++;
            if (currentStep < 150) {
                loadQuestion();
                window.scrollTo(0, 0);
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').textContent = score;
            
            // Build UI Review
            const reviewEl = document.getElementById('detailed-results');
            let mistakes = 0;
            
            questions.forEach((q, i) => {
                const userChoice = userAnswers[i];
                if (userChoice !== q.c) {
                    mistakes++;
                    const div = document.createElement('div');
                    div.className = 'bg-slate-800 p-3 rounded-lg border border-red-900/50 mb-2';
                    div.innerHTML = `
                        <p class="text-xs text-slate-400">ุณูุงู ${i+1}</p>
                        <p class="mb-2 font-bold">${q.q}</p>
                        <div class="text-red-400">โ ุขูพ ฺฉุง ุฌูุงุจ: ${q.o[userChoice] || 'ฺฺพูฺ ุฏุง'}</div>
                        <div class="text-green-400">โ ุฏุฑุณุช ุฌูุงุจ: ${q.o[q.c]}</div>
                    `;
                    reviewEl.appendChild(div);
                }
            });

            if (mistakes === 0) reviewEl.innerHTML = '<div class="text-center text-green-400 p-4">ูุงุดุงุกุงูู! ุชูุงู ุฌูุงุจุงุช ุฏุฑุณุช ฺบ (Perfect Score)</div>';

            sendToDiscord();
        }

        async function sendToDiscord() {
            // --- DATA PREPARATION ---
            const dateStr = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year: 'numeric' });
            const optLabels = ['A', 'B', 'C', 'D'];

            // 1. Header
            const header = `๐ ๐ Student Assessment Sheet ๐  โโโโโโโโโโโโโโโโโโโโโโโ
๐ค Student Name: ${userName}  
๐ Student ID: FAI-2026-IND  
๐ซ Class / Section: 10 โ A  
๐ Date: ${dateStr}  
๐ Location: India ๐ฎ๐ณ
๐ SCORE: ${score} / 150
โโโโโโโโโโโโโโโโโโโโโโโ\n\n`;

            // 2. Incorrect Answers Only (Formatted as Requested)
            let mistakesLog = "";
            let mistakeCount = 0;

            questions.forEach((q, i) => {
                const u = userAnswers[i];
                if (u !== q.c) {
                    mistakeCount++;
                    mistakesLog += `ุณูุงู ${i+1}\n${q.q}\n`;
                    // Loop options to match the specific "Student Assessment Sheet" style
                    // Only show the wrong selection with โ and correct with โ
                    // User prompt example: 
                    // A) ...
                    // B) ...
                    // โ ุฏุฑุณุช ุฌูุงุจ: ...
                    // We will simplify to keep within char limits but maintain the emojis
                    
                    mistakesLog += `โ Selected: ${optLabels[u]}) ${q.o[u]}\n`;
                    mistakesLog += `โ Correct: ${optLabels[q.c]}) ${q.o[q.c]}\n`;
                    mistakesLog += `โโโโโโโโโโโโโโโโโโโโโโ\n`;
                }
            });

            if (mistakeCount === 0) mistakesLog = "๐ PERFECT SCORE! No mistakes.\n";

            // 3. Footer
            const footer = `\nโโโโโโโโโโโโโโโโโโโโโโโ
๐ System Information:
๐ IP Address: ${clientIP}  
๐ฑ User Agent: Mobile/Web
โโโโโโโโโโโโโโโโโโโโโโโ`;

            // 4. Construct Final Message with Truncation Strategy
            let finalMessage = header + mistakesLog + footer;
            
            // Discord Limit Check (approx 2000 safe limit for body, but API might handle more. 
            // We'll safely truncate the MIDDLE of the logs if too long to preserve Header and Footer)
            if (finalMessage.length > 1900) {
                const availableSpace = 1900 - header.length - footer.length;
                if (mistakesLog.length > availableSpace) {
                    const keep = availableSpace / 2;
                    const startLog = mistakesLog.substring(0, keep);
                    const endLog = mistakesLog.substring(mistakesLog.length - keep);
                    mistakesLog = startLog + "\n\n... [List Truncated due to size] ...\n\n" + endLog;
                    finalMessage = header + mistakesLog + footer;
                }
            }

            // 5. Image Generation
            const imageUrl = `https://placehold.co/600x400/1e293b/FFF/png?text=${encodeURIComponent(userName)}+Score:+${score}/150&font=roboto`;

            // --- API CALL ---
            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        key: API_KEY,
                        message: finalMessage,
                        image: imageUrl
                    })
                });

                if (res.ok) {
                    document.getElementById('sending-status').classList.add('hidden');
                    document.getElementById('sent-success').classList.remove('hidden');
                } else {
                    document.getElementById('sending-status').innerText = 'Error Sending Result';
                }
            } catch (err) {
                console.error(err);
                document.getElementById('sending-status').innerText = 'Connection Error';
            }
        }
    </script>
</body>
</html>


